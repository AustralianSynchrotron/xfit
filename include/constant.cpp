/***********************************************************************}
{                                                                       }
{  This file contains the definitions and declarations of data          }
{  structures containing constants such as X-ray edge types and atom    }
{  numbers and names and the routines used to access them.              }
{                                                                       }
{  Copyright (C) Paul J. Ellis, University of Sydney, 1993.             }
{                                                                       }
{***********************************************************************/

#if !defined (__CONSTANTS_C__)

#define __CONSTANTS_C__

#include "constant.h"


static edge_type __X_ray_edge_names__ [] = {

  { 1, "K"    },
  { 2, "L1"   }, { 2, "Li"   },
  { 3, "L2"   }, { 3, "Lii"  },
  { 4, "L3"   }, { 4, "Liii" },

  { 0 }

  };

static atom_type __atom_names__ [] = {

  {   1, "H" , 3, "hydrogen"      }, {   2, "He", 3, "helium"       },
  {   3, "Li", 3, "lithium"       }, {   4, "Be", 4, "beryllium"    },
  {   5, "B" , 3, "boron"         }, {   6, "C" , 3, "carbon"       },
  {   7, "N" , 3, "nitrogen"      }, {   8, "O" , 3, "oxygen"       },
  {   9, "F" , 3, "fluorine"      }, {  10, "Ne", 4, "neon"         },
  {  11, "Na", 3, "sodium"        }, {  12, "Mg", 3, "magnesium"    },
  {  13, "Al", 3, "aluminium"     }, {  14, "Si", 4, "silicon"      },
  {  15, "P" , 3, "phosphorus"    }, {  16, "S" , 3, "sulfur"       },
  {  17, "Cl", 3, "chlorine"      }, {  18, "Ar", 3, "argon"        },
  {  19, "K" , 3, "potassium"     }, {  20, "Ca", 4, "calcium"      },
  {  21, "Sc", 3, "scandium"      }, {  22, "Ti", 3, "titanium"     },
  {  23, "V" , 3, "vanadium"      }, {  24, "Cr", 3, "chromium"     },
  {  25, "Mn", 3, "manganese"     }, {  26, "Fe", 3, "iron"         },
  {  27, "Co", 3, "cobalt"        }, {  28, "Ni", 3, "nickel"       },
  {  29, "Cu", 3, "copper"        }, {  30, "Zn", 3, "zinc"         },
  {  31, "Ga", 3, "gallium"       }, {  32, "Ge", 3, "germanium"    },
  {  33, "As", 3, "arsenic"       }, {  34, "Se", 3, "selenium"     },
  {  35, "Br", 3, "bromine"       }, {  36, "Kr", 3, "krypton"      },
  {  37, "Rb", 3, "rubidium"      }, {  38, "Sr", 3, "strontium"    },
  {  39, "Y" , 4, "yttrium"       }, {  40, "Zr", 3, "zirconium"    },
  {  41, "Nb", 3, "niobium"       }, {  42, "Mo", 3, "molybdenum"   },
  {  43, "Tc", 3, "technetium"    }, {  44, "Ru", 3, "ruthenium"    },
  {  45, "Rh", 3, "rhodium"       }, {  46, "Pd", 3, "palladium"    },
  {  47, "Ag", 4, "silver"        }, {  48, "Cd", 3, "cadmium"      },
  {  49, "In", 3, "indium"        }, {  50, "Sn", 3, "tin"          },
  {  51, "Sb", 3, "antimony"      }, {  52, "Te", 3, "tellurium"    },
  {  53, "I" , 3, "iodine"        }, {  54, "Xe", 3, "xenon"        },
  {  55, "Cs", 3, "caesium"       }, {  56, "Ba", 3, "barium"       },
  {  57, "La", 3, "lanthanum"     }, {  58, "Ce", 3, "cerium"       },
  {  59, "Pr", 3, "praseodymium"  }, {  60, "Nd", 4, "neodymium"    },
  {  61, "Pm", 4, "promethium"    }, {  62, "Sm", 3, "samarium"     },
  {  63, "Eu", 3, "europium"      }, {  64, "Gd", 3, "gadolinium"   },
  {  65, "Tb", 3, "terbium"       }, {  66, "Dy", 3, "dysprosium"   },
  {  67, "Ho", 3, "holmium"       }, {  68, "Er", 3, "erbium"       },
  {  69, "Tm", 3, "thulium"       }, {  70, "Yb", 4, "ytterbium"    },
  {  71, "Lu", 3, "lutetium"      }, {  72, "Hf", 3, "hafnium"      },
  {  73, "Ta", 3, "tantalum"      }, {  74, "W" , 3, "tungsten"     },
  {  75, "Re", 3, "rhenium"       }, {  76, "Os", 3, "osmium"       },
  {  77, "Ir", 3, "iridium"       }, {  78, "Pt", 3, "platinum"     },
  {  79, "Au", 3, "gold"          }, {  80, "Hg", 3, "mercury"      },
  {  81, "Tl", 3, "thallium"      }, {  82, "Pb", 3, "lead"         },
  {  83, "Bi", 3, "bismuth"       }, {  84, "Po", 3, "polonium"     },
  {  85, "At", 3, "astatine"      }, {  86, "Rn", 4, "radon"        },
  {  87, "Fr", 3, "francium"      }, {  88, "Ra", 4, "radium"       },
  {  89, "Ac", 3, "actinium"      }, {  90, "Th", 3, "thorium"      },
  {  91, "Pa", 4, "protactinium"  }, {  92, "U" , 3, "uranium"      },
  {  93, "Np", 3, "neptunium"     }, {  94, "Pu", 3, "plutonium"    },

  {  95, "Am", 3, "americium"     }, {  96, "Cm", 3, "curium"       },
  {  97, "Bk", 4, "berkelium"     }, {  98, "Cf", 4, "californium"  },
  {  99, "Es", 3, "einsteinium"   }, { 100, "Fm", 3, "fermium"      },
  { 101, "Md", 3, "mendelevium"   }, { 102, "No", 3, "nobelium"     },
  { 103, "Lr", 3, "lawrencium"    },

  { 104, "Rf", 3, "rutherfordium" }, { 104, "Uq", 3, "unnilquadium" },
  { 105, "Ha", 3, "hahnium"       }, { 105, "Up", 3, "unnilpentium" },
                                     { 106, "Uh", 3, "unnilhexium"  },

  {  13, "Al", 3, "aluminum"      }, {  16, "S" , 3, "sulphur"      },

  {   0, "" }

  };

char * X_ray_edge_symbol (int edge) {

  edge_type * E;

  for (E = __X_ray_edge_names__; E->code; E++)

    if (edge == E->code)

      return E->name;

  return NULL;

  }

int X_ray_edge_code (char name []) {

  edge_type * E;

  for (E = __X_ray_edge_names__; E->code; E++)

    if (!strcasecmp (name, E->name))

       return E->code;

  return 0;

  }

char * atom_symbol (int Z) {

  atom_type * A;

  for (A = __atom_names__; A->number; A++)

    if (Z == A->number)

      return A->symbol;

  return NULL;

  }

char * atom_name (int Z) {

  atom_type * A;

  for (A = __atom_names__; A->number; A++)

    if (Z == A->number)

      return A->name;

  return NULL;

  }

int atomic_number (char name []) {

  atom_type * A;

  for (A = __atom_names__; A->number; A++)

    if (!strcasecmp (name, A->symbol) ||
        !uniquestrlencasecmp (name, A->name, A->unique))

       return A->number;

  return 0;

  }


/***********************************************************************}
{                                                                       }
{  Parameters for C1...D5 are taken from Table 3.2.2c of                }
{  International Tables for X-ray Crystallography, Vol. 3 (1962),       }
{  pp 171-3.  Parameters for edge energies are from the McMaster        }
{  tables, calculated by adding 15-20 eV to the McMaster value.         }
{                                                                       }
{***********************************************************************/

static X_ray_absorption_parameters_type __X_ray_absorption_parameters__ [] = {

  {   1, "H",    1.00797, 1.2  , 0    , 0    , 0.37 ,

               {     0        },
               {     0        },
               {     0.0127   },
               {     4.66e-6  } },

  {   2, "He",   4.00260, 1.2  , 0.49 , 0    , 0.93 ,

               {     0        },
               {     0        },
               {     0.0514   },
               {     7.52e-5  } },

  {   3, "Li",   6.941,   2.05 , 2.05 , 1.52 , 1.23 ,

               {    54.75     },
               {     0        },
               {     0.150    },
               {     4.94e-4  } },

  {   4, "Be",   9.01218, 1.4  , 1.4  , 1.12 , 0.90 ,

               {   111.0      },
               {     0        },
               {     0.365    },
               {     0.00213  } },

  {   5, "B",   10.81,    1.4  , 1.17 , 0    , 0.82 ,

               {     0        },
               {     0        },
               {     0.609    },
               {     0.00451  } },

  {   6, "C",   12.011,   1.4  , 0.91 , 0    , 0.77 ,

               {   283.8      },
               {     0        },
               {     1.22     },
               {     0.0142   } },

  {   7, "N",   14.0067,  1.5  , 0.75 , 0    , 0.75 ,

               {     0        },
               {     0        },
               {     2.05     },
               {     0.0317   } },

  {   8, "O",   15.9994,  1.4  , 0.65 , 0    , 0.73 ,

               {     0        },
               {     0        },
               {     3.18     },
               {     0.0654   } },

  {   9, "F",   18.9984,  1.35 , 0.57 , 0    , 0.72 ,

               {     0        },
               {     0        },
               {     4.60     },
               {     0.112    } },

  {  10, "Ne",  20.179,   2.34 , 0.51 , 0    , 0.71 ,

               {   865.9      },
               {     0        },
               {     6.51     },
               {     0.206    } },

  {  11, "Na",  22.98977, 2.23 , 2.23 , 1.86 , 1.54 ,

               {  1072        },
               {     0        },
               {     8.67     },
               {     0.330    } },

  {  12, "Mg",  24.305,   1.72 , 1.72 , 1.60 , 1.36 ,

               {  1304        },
               {     0        },
               {    11.3      },
               {     0.539    } },

  {  13, "Al",  26.98154, 1.82 , 1.82 , 1.43 , 1.18 ,

               {  1559.8      },
               {     0        },
               {    14.4      },
               {     0.803    } },

  {  14, "Si",  28.0855,  1.46 , 1.46 , 0    , 1.11 ,

               {  1839        },
               {     0        },
               {    18.2      },
               {     1.10     } },

  {  15, "P",   30.97376, 1.9  , 1.23  , 0    , 1.06 ,

               {  2149        },
               {  2160        },
               {    22.6      },
               {     1.55     } },

  {  16, "S",   32.06,    1.85 , 1.09 , 0    , 1.02 ,

               {  2471        },
               {  2490        },
               {    27.6      },
               {     2.18     } },

  {  17, "Cl",  35.453,   1.8  , 0.97 , 0    , 0.99 ,

               {  2821        },
               {  2840        },
               {    33.4      },
               {     3.03     } },

  {  18, "Ar",  39.948,   2.86 , 0.88 , 0    , 0.98 ,

               {  3202.9      },
               {     0        },
               {    40.0      },
               {     4.18     } },

  {  19, "K",   39.0983,  2.75 , 2.77 , 2.27 , 2.03 ,

               {  3607.8      },
               {  3625        },
               {    47.4      },
               {     5.59     } },

  {  20, "Ca",  40.08,    0    , 0    , 1.97 , 1.74 ,

               {  4038.1      },
               {  4055        },
               {    55.8      },
               {     7.56     } },

  {  21, "Sc",  44.9559,  0    , 2.09 , 1.61 , 1.44 ,

               {  4493        },
               {  4510        },
               {    65.2      },
               {     9.81     } },

  {  22, "Ti",  47.88,    0    , 2.0  , 1.45 , 1.32 ,

               {  4964.5               },
               {  4985                 },
               {    75.6  ,     5.15   },
               {    12.3  ,     0.153  } },

  {  23, "V",   50.9414,  0    , 1.92 , 1.31 , 1.22 ,

               {  5464                 },
               {  5485                 },
               {    86.9  ,     6.14   },
               {    15.1  ,     0.203  } },

  {  24, "Cr",  51.996,   0    , 1.85 , 1.25 , 1.18 ,

               {  5989                 },
               {  6005                 },
               {    99.0  ,     7.24   },
               {    18.2  ,     0.268  } },

  {  25, "Mn",  54.9380,  0    , 1.79 , 1.37 , 1.17 ,

               {  6539                 },
               {  6555                 },
               {   112    ,     8.51   },
               {    22.3  ,     0.344  } },

  {  26, "Fe",  55.847,   0    , 1.72 , 1.24 , 1.17 ,

               {  7111.2  ,     0    ,   720.8  ,   707.4  },
               {  7130                                     },
               {   126    ,     9.95                       },
               {    27.2  ,     0.433                      } },

  {  27, "Co",  58.9332,  0    , 1.67 , 1.25 , 1.16 ,

               {  7709.5  ,     0    ,   793.8  ,   779.0  },
               {  7725                                     },
               {   141    ,    11.6                        },
               {    33.2  ,     0.535                      } },

  {  28, "Ni",  58.69,    1.63 , 1.62 , 1.25 , 1.15 ,

               {  8331.6  ,  1012    ,   870.6  ,   853.6  },
               {  8350                                     },
               {   158    ,    13.4                        },
               {    40.1  ,     0.651                      } },

  {  29, "Cu",  63.546,   1.4  , 1.57 , 1.28 , 1.17 ,

               {  8980.3  ,  1100    ,   952    ,   932    },
               {  9000                                     },
               {   176    ,    15.6                        },
               {    48.3  ,     0.779                      } },

  {  30, "Zn",  65.377,   1.39 , 1.53 , 1.33 , 1.25 ,

               {  9660.7  ,  1196    ,  1044    ,  1022    },
               {  9675                                     },
               {   195    ,    17.8                        },
               {    57.7  ,     0.937                      } },

  {  31, "Ga",  69.72,    1.89 , 1.81 , 1.22 , 1.26 ,

               { 10368.2  ,  1302    ,  1142    ,  1116    },
               { 10385                                     },
               {   216    ,    20.2                        },
               {    68.6  ,     1.13                       } },

  {  32, "Ge",  72.59,    1.98 , 1.52 , 1.23 , 1.22 ,

               { 11103.6  ,  1414    ,  1249    ,  1217.0  },
               { 11120                                     },
               {   238    ,    22.7                        },
               {    81.1  ,     1.37                       } },

  {  33, "As",  74.9216,  2.0  , 1.33 , 1.25 , 1.20 ,

               { 11866    ,  1530    ,  1358.7  ,  1323.5  },
               { 11885                                     },
               {   262    ,    25.3                        },
               {    95.4  ,     1.67                       } },

  {  34, "Se",  78.96,    2.0  , 1.22 , 1.16 , 1.16 ,

               { 12656    ,  1652.5  ,  1474.7  ,  1430.0  },
               { 12675                                     },
               {   287    ,    28.0                        },
               {   112    ,     2.02                       } },

  {  35, "Br",  79.904,   1.95 , 1.12 , 0    , 1.14 ,

               { 13472    ,  1782    ,  1596    ,  1550    },
               { 13490                                     },
               {   314    ,    30.9                        },
               {   130    ,     2.43                       } },

  {  36, "Kr",  83.80,    2.02 , 1.03 , 0    , 1.12 ,

               { 14323    ,  1920    ,  1728    ,  1676    },
               { 14345                                     },
               {   343    ,    33.9                        },
               {   151    ,     2.92                       } },

  {  37, "Rb",  85.4678,  0    , 2.98 , 2.48 , 2.16 ,

               { 15201    ,  2065    ,  1863    ,  1805    },
               { 15215                                     },
               {   374    ,    37.1                        },
               {   174    ,     3.48                       } },

  {  38, "Sr",  87.62,    0    , 2.45 , 2.15 , 1.91 ,

               { 16106    ,  2216    ,  2008.5  ,  1940    },
               { 16120                                     },
               {   406    ,    40.5                        },
               {   200    ,     4.14                       } },

  {  39, "Y",   88.9059,  0    , 2.27 , 1.78 , 1.62 ,

               { 17038    ,  2373    ,  2154.0  ,  2079.4  },
               { 17055                                     },
               {   441    ,    44.1                        },
               {   229    ,     4.88                       } },

  {  40, "Zr",  91.22,    0    , 2.16 , 1.59 , 1.45 ,

               { 17998    ,  2532    ,  2305.3  ,  2222.5  },
               { 18015                                     },
               {   477    ,    47.9                        },
               {   261    ,     5.72                       } },

  {  41, "Nb",  92.9064,  0    , 2.08 , 1.43 , 1.34 ,

               { 18986    ,  2698    ,  2465    ,  2371    },
               { 19005                                     },
               {   515    ,    51.9                        },
               {   296    ,     6.67                       } },

  {  42, "Mo",  95.94,    0    , 2.01 , 1.36 , 1.3  ,

               { 20003.9  ,  2866    ,  2626    ,  2523.2  },
               { 20025    ,  2885    ,  2640    ,  2535    },
               {   555    ,    56.2                        },
               {   336    ,     7.73                       } },

  {  43, "Tc",  98.9062,  0    , 1.95 , 1.35 , 1.27 ,

               { 21045    ,  3043    ,  2793    ,  2677    },
               { 21060                                     },
               {   597    ,    60.7                        },
               {   379    ,     8.91                       } },

  {  44, "Ru",  101.07,   0    , 1.89 , 1.33 , 1.25 ,

               { 22118    ,  3224    ,  2966.3  ,  2937.7  },
               { 22135    ,  3240    ,  2985    ,  2855    },
               {   641    ,    65.5                        },
               {   427    ,    10.1                        } },

  {  45, "Rh",  102.9055, 0    , 1.83 , 1.34 , 1.25 ,

               { 23219.8  ,  3414    ,  3146    ,  3002    },
               { 23235                                     },
               {   686    ,    70.5                        },
               {   479    ,    11.4                        } },

  {  46, "Pd",  106.42,   1.63 , 1.79 , 1.38 , 1.28 ,

               { 24349    ,  3606    ,  3330.3  ,  3173.0  },
               { 24370                                     },
               {   734    ,    75.8                        },
               {   537    ,    12.8                        } },

  {  47, "Ag",  107.868,  1.72 , 1.75 , 1.44 , 1.34 ,

               { 25515    ,  3806    ,  3525    ,  3351.0  },
               { 25530                                     },
               {   784    ,    81.4                        },
               {   599    ,    14.3                        } },

  {  48, "Cd",  112.41,   1.58 , 1.71 , 1.49 , 1.48 ,

               { 26714    ,  4018    ,  3728    ,  3537.6  },
               { 26730                                     },
               {   835    ,    87.4                        },
               {   667    ,    15.9                        } },

  {  49, "In",  114.82,   1.93 , 2.   , 1.36 , 1.44 ,

               { 27940    ,  4237.3  ,  3939.3  ,  3730.2  },
               { 27960    ,  4255    ,  3955    ,  3750    },
               {   889    ,    93.6                        },
               {   741    ,    17.7                        } },

  {  50, "Sn",  118.69,   2.17 , 1.72 , 1.51 , 1.41 ,

               { 29198    ,  4464.8  ,  4156    ,  3928.8  },
               { 29220                                     },
               {   944    ,   100                          },
               {   821    ,    19.7                        } },

  {  51, "Sb",  121.75,   2.2  , 1.53 , 1.45 , 1.40 ,

               { 30488    ,  4698.4  ,  4382    ,  4132.3              },
               { 30510    ,  4715    ,  4400    ,  4150                },
               {  1000    ,   107    ,    85.8  ,    35.4  ,     7.8   },
               {   908    ,    21.8  ,    11.9  ,     3.85 ,     0.23  } },

  {  52, "Te",  127.60,   2.2  , 1.42 , 1.43 , 1.36 ,

               { 31812    ,  4939.7  ,  4612.6  ,  4341.8              },
               { 31830    ,  4955    ,  4630    ,  4360                },
               {  1060    ,   114    ,    92.5  ,    39.1  ,    10.1   },
               {  1000    ,    24.3  ,    14.3  ,     4.48 ,     0.48  } },

  {  53, "I",   126.9045, 2.15 , 1.32 , 0    , 1.33 ,

               { 33168    ,  5188    ,  4852    ,  4557                },
               { 33185    ,  5205    ,  4870    ,  4575                },
               {  1120    ,   122    ,    99.6  ,    43    ,    12.4   },
               {  1100    ,    27.1  ,    16.6  ,     5.19 ,     0.761 } },

  {  54, "Xe",  131.29,   2.16 , 1.24 , 0    , 1.31 ,

               { 34586    ,  5452.8  ,  5103.7  ,  4782.2              },
               {     0    ,  5470    ,  5120    ,  4800                },
               {  1180    ,   130    ,   107    ,    47.2  ,    14.7   },
               {  1210    ,    30.2  ,    19    ,     5.98 ,     1.06  } },

  {  55, "Cs",  132.9054, 0    , 3.34 , 2.65 , 2.35 ,

               { 35986    ,  5717    ,  5358    ,  5011.3              },
               { 36005                                                 },
               {  1250    ,   139    ,   115    ,    51.7  ,    17.0   },
               {  1330    ,    33.6  ,    21.4  ,     6.87 ,     1.38  } },

  {  56, "Ba",  137.33,   0    , 2.78 , 2.17 , 1.98 ,

               { 37446    ,  5992    ,  5623.3  ,  5247.0              },
               {     0                                                 },
               {  1310    ,   147    ,   123    ,    56.3  ,    19.2   },
               {  1460    ,    37.3  ,    24.0  ,     7.86 ,     1.72  } },

  {  57, "La",  138.9055, 0    , 2.74 , 1.87 , 1.69 ,

               { 38930    ,  6267    ,  5891    ,  5483                },
               {     0                                                 },
               {  1380    ,   157    ,   131    ,    61.2  ,    21.5   },
               {  1590    ,    41.3  ,    26.8  ,     8.96 ,     2.07  } },

  {  58, "Ce",  140.12,   0    , 2.7  , 1.83 , 1.65 ,

               { 40448    ,  6549    ,  6165    ,  5724                },
               {     0                                                 },
               {  1450    ,   166    ,   140    ,    66.3  ,    23.8   },
               {  1740    ,    45.6  ,    29.6  ,    10.2  ,     2.44  } },

  {  59, "Pr",  140.0977, 0    , 2.67 , 1.82 , 1.65 ,

               { 41996    ,  6835    ,  6441    ,  5965                },
               {     0                                                 },
               {     0    ,   176    ,   149    ,    71.7  ,    26.1   },
               {     0    ,    50.2  ,    32.7  ,    11.5  ,     2.83  } },

  {  60, "Nd",  144.24,   0    , 2.64 , 1.81 , 1.64 ,

               { 43572    ,  7128    ,  6722    ,  6208                },
               {     0                                                 },
               {     0    ,   187    ,   159    ,    77.4  ,    28.4   },
               {     0    ,    55.1  ,    36.0  ,    13.0  ,     3.24  } },

  {  61, "Pm",  145,      0    , 2.62 , 0    , 1.63 ,

               { 45191    ,  7428    ,  7013    ,  6460                },
               {     0                                                 },
               {     0    ,   198    ,   169    ,    83.3  ,    30.7   },
               {     0    ,    60.3  ,    39.7  ,    14.7  ,     3.67  } },

  {  62, "Sm",  150.36,   0    , 2.59 , 1.79 , 1.62 ,

               { 46842    ,  7742    ,  7312    ,  6717                },
               {     0                                                 },
               {     0    ,   210    ,   179    ,    89.6  ,    33.1   },
               {     0    ,    65.8  ,    43.6  ,    16.5  ,     4.12  } },

  {  63, "Eu",  151.96,   0    , 2.56 , 1.99 , 1.85 ,

               { 48520    ,  8056    ,  7619    ,  6979                },
               {     0                                                 },
               {     0    ,   222    ,   190    ,    96.1  ,    35.4   },
               {     0    ,    71.6  ,    48.0  ,    18.5  ,     4.61  } },

  {  64, "Gd",  157.25,   0    , 2.54 , 1.79 , 1.61 ,

               { 50326    ,  8381    ,  7931    ,  7243                },
               {     0                                                 },
               {     0    ,   234    ,   201    ,   103    ,    37.8   },
               {     0    ,    77.7  ,    52.7  ,    20.7  ,     5.11  } },

  {  65, "Tb",  158.9254, 0    , 2.51 , 1.76 , 1.59 ,

               { 51999    ,  8712    ,  8252    ,  7515                },
               { 52015    ,  8725    ,  8270    ,  7530                },
               {     0    ,   247    ,   213    ,   110    ,    40.3   },
               {     0    ,    84.1  ,    57.8  ,    23.1  ,     5.64  } },

  {  66, "Dy",  162.50,   0    , 2.49 , 1.75 , 1.59 ,

               { 53791    ,  9047    ,  8582    ,  7789.7              },
               {     0                                                 },
               {     0    ,   261    ,   225    ,   118    ,    42.8   },
               {     0    ,    90.8  ,    63.4  ,    25.7  ,     6.20  } },

  {  67, "Ho",  164.9304, 0    , 2.47 , 1.74 , 1.58 ,

               { 55618    ,  9397    ,  8918    ,  8070                },
               {     0                                                 },
               {     0    ,   275    ,   237    ,   125    ,    45.4   },
               {     0    ,    98.0  ,    69.5  ,    28.5  ,     6.79  } },

  {  68, "Er",  167.26,   0    , 2.45 , 1.73 , 1.57 ,

               { 57486    ,  9754    ,  9264    ,  8357.5                },
               { 57505    ,  9770    ,  9280    ,  8375                },
               {     0    ,   290    ,   250    ,   133    ,    48     },
               {     0    ,   105    ,    76.1  ,    31.6  ,     7.41  } },

  {  69, "Tm",  168.9342, 0    , 2.42 , 0    , 1.56 ,

               { 59390    , 10118    ,  9617.1  ,  8649.6              },
               {     0                                                 },
               {     0    ,   305    ,   264    ,   142    ,    50.7   },
               {     0    ,   113    ,    83.3  ,    34.8  ,     8.06  } },

  {  70, "Yb",  173.04,   0    , 2.4  , 1.94 , 1.74 ,

               { 61332    , 10489    ,  9977    ,  8944.1              },
               {     0                                                 },
               {     0    ,   321    ,   277    ,   151    ,    53.4   },
               {     0    ,   121    ,    91.1  ,    38.4  ,     8.75  } },

  {  71, "Lu",  174.97,   0    , 2.25 , 1.72 , 1.56 ,

               { 63312    , 10872    , 10347    ,  9244                },
               {     0                                                 },
               {     0    ,   337    ,   292    ,   160    ,    56.2   },
               {     0    ,   130    ,    99.5  ,    42.2  ,     9.47  } },

  {  72, "Hf",  178.49,   0    , 2.16 , 1.56 , 1.44 ,

               { 65351    , 11273    , 10738    ,  9560                },
               {     0                                                 },
               {     0    ,   354    ,   307    ,   169    ,    59.2   },
               {     0    ,   140    ,   109    ,    46.2  ,    10.2   } },

  {  73, "Ta",  180.9479, 0    , 2.09 , 1.43 , 1.34 ,

               { 67416    , 11681    , 11134    ,  9877.7              },
               {     0    , 11700    , 11155    ,  9900                },
               {     0    ,   372    ,   322    ,   179    ,    62.2   },
               {     0    ,   150    ,   118    ,    50.5  ,    11.0   } },

  {  74, "W",   183.85,   0    , 2.02 , 1.37 , 1.3  ,

               { 69516    , 12099.6  , 11540    , 10202                },
               { 69540    , 12115    , 11560    , 10225                },
               {     0    ,   390    ,   338    ,   190    ,    65.3   },
               {     0    ,   161    ,   129    ,    55.2  ,    11.9   } },

  {  75, "Re",  186.207,  0    , 1.97 , 1.37 , 1.28 ,

               { 71667    , 12528    , 11956    , 10532                },
               {     0    , 12545    , 11975    , 10555                },
               {     0    ,   409    ,   354    ,   200    ,    68.4   },
               {     0    ,   173    ,   140    ,    60.1  ,    12.7   } },

  {  76, "Os",  190.2,    0    , 1.92 , 1.34 , 1.26 ,

               { 73872    , 12968    , 12382    , 10870                },
               { 73890    , 12985    , 12405    , 10890                },
               {     0    ,   429    ,   371    ,   212    ,    71.8   },
               {     0    ,   187    ,   152    ,    65.4  ,    13.6   } },

  {  77, "Ir",  192.22,   0    , 1.87 , 1.36 , 1.27 ,

               { 76112    , 13424    , 12822    , 11214                },
               {     0    , 13435    , 12840    , 11235                },
               {     0    ,   449    ,   389    ,   223    ,    75.2   },
               {     0    ,   202    ,   165    ,    70.9  ,    14.6   } },

  {  78, "Pt",  195.08,   1.75 , 1.83 , 1.39 , 1.3  ,

               { 78388    , 13888    , 13272.3  , 11563                },
               { 78415    , 13895    , 13290    , 11580                },
               {     0    ,   470    ,   407    ,   235    ,    78.7   },
               {     0    ,   219    ,   179    ,    76.8  ,    15.6   } },

  {  79, "Au",  196.9665, 1.66 , 1.79 , 1.44 , 1.34 ,

               { 80722    , 14353.7  , 13734    , 11920                },
               { 80740    , 14370    , 13750    , 11935                },
               {     0    ,   492    ,   425    ,   247    ,    82.3   },
               {     0    ,   240    ,   194    ,    83    ,    16.6   } },

  {  80, "Hg",  200.59,   1.55 , 1.76 , 1.50 , 1.49 ,

               { 83103    , 14844    , 14212    , 12285                },
               { 83120    , 14855    , 14225    , 12300                },
               {     0    ,   514    ,   444    ,   260    ,    86.1   },
               {     0    ,   265    ,   210    ,    89.6  ,    17.7   } },

  {  81, "Tl",  204.38,   1.96 , 2.08 , 1.70 , 1.48 ,

               { 85528    , 15344    , 14698    , 12658                },
               { 85545                                                 },
               {     0    ,   540    ,   464    ,   274    ,    90.0   },
               {     0    ,   295    ,   226    ,    96.6  ,    18.9   } },

  {  82, "Pb",  207.2,    2.02 , 1.81 , 1.75 , 1.47 ,

               { 88006    , 15858    , 15202    , 13038                },
               { 88025    , 15880    , 15215    , 13055                },
               {     0    ,   570    ,   484    ,   287    ,    94.1   },
               {     0    ,   333    ,   244    ,   104    ,    20.0   } },

  {  83, "Bi",  208.9804, 0    , 1.63 , 1.55 , 1.46 ,

               { 90530    , 16380    , 15714    , 13422                },
               {     0    , 16400    , 15725    , 13435                },
               {     0    ,   605    ,   505    ,   302    ,    98.3   },
               {     0    ,   382    ,   263    ,   112    ,    21.3   } },

  /* Po : 1.53 0 1.46     At : 0 0 1.43 */

  {  86, "Rn",  222,      0    , 1.34 , 0    , 0    ,

               { 98417    , 18055    , 17334    , 14612                },
               {     0    ,     0    ,     0    ,     0                },
               {     0    ,     0    ,     0    ,     0    ,     0     },
               {     0    ,     0    ,     0    ,     0    ,     0     } },

  {  88, "Ra",  226.0254, 0    , 0    , 0    , 0    ,

               {     0    , 19236.0  , 18486.0  , 15444.0              },
               {     0    ,     0    ,     0    ,     0                },
               {     0    ,     0    ,     0    ,     0    ,     0     },
               {     0    ,     0    ,     0    ,     0    ,     0     } },

  {  90, "Th",  232.0381, 0    , 0    , 1.80 , 1.65 ,

               { 109649    , 20467    , 19688    , 16300                },
               {      0    ,     0    ,     0    ,     0                },
               {      0    ,     0    ,     0    ,     0    ,     0     },
               {      0    ,     0    ,     0    ,     0    ,     0     } },

  {  91, "Pa",  231.0359, 0    , 0    , 1.61 , 0    ,

               {      0    , 21128    , 20319    , 16733                },
               {      0    ,     0    ,     0    ,     0                },
               {      0    ,     0    ,     0    ,     0    ,     0     },
               {      0    ,     0    ,     0    ,     0    ,     0     } },

  {  92, "U",   238.029,  1.86 , 1.86 , 1.39 , 1.42 ,

               { 115603    , 21764    , 20946    , 17166                },
               {      0    ,     0    ,     0    ,     0                },
               {      0    ,     0    ,     0    ,     0    ,     0     },
               {      0    ,     0    ,     0    ,     0    ,     0     } },

  {  93, "Np",  237.0482, 0    , 0    , 1.30 , 0    ,

               {      0    ,     0    ,     0    , 17606.2              },
               {      0    ,     0    ,     0    ,     0                },
               {      0    ,     0    ,     0    ,     0    ,     0     },
               {      0    ,     0    ,     0    ,     0    ,     0     } },

  {  94, "Pu",  244,      0    , 0    , 1.51 , 0    ,

               { 121760    , 23102    , 22258    , 18053.1              },
               {      0    ,     0    ,     0    ,     0                },
               {      0    ,     0    ,     0    ,     0    ,     0     },
               {      0    ,     0    ,     0    ,     0    ,     0     } },

  {  95, "Am",  243,      0    , 0    , 1.82 , 0    ,

               {      0    ,     0    ,     0    , 18504.1              },
               {      0    ,     0    ,     0    ,     0                },
               {      0    ,     0    ,     0    ,     0    ,     0     },
               {      0    ,     0    ,     0    ,     0    ,     0     } },

  { 0 }

  };

X_ray_absorption_parameters_type * __X_ray_AP_entry__ (int Z) {

  X_ray_absorption_parameters_type * X;

  for (X = __X_ray_absorption_parameters__; X->number; X++)

    if (X->number == Z)

      return X;

  return NULL;

  }

double VdW_radius (int Z) {

  X_ray_absorption_parameters_type * X;

  if (X = __X_ray_AP_entry__ (Z)) {

    if (X->VdW)

      return X->VdW;

    if (X->atomic)

      return X->atomic;

    if (X->metallic)

      return X->metallic + 0.5;

    if (X->covalent)

      return X->covalent + 0.65;

    return 2.0;

    }

  return 0;

  }

double covalent_radius (int Z) {

  X_ray_absorption_parameters_type *X;

  if (X = __X_ray_AP_entry__ (Z)) {

      /* Have covalent radii up to Bi = 83 */

    if (X->covalent)

      return X->covalent;

    return 1.5;

    }

  return 0;

  }

double atomic_mass (int Z) {

  X_ray_absorption_parameters_type * X;

  if (X = __X_ray_AP_entry__ (Z))

    return X->mass;

  return 0;

  }

double ionisation_energy (int Z, int edge) {

  X_ray_absorption_parameters_type * X;

  if (edge < 1 || edge > 4)

    return 0;

  if (X = __X_ray_AP_entry__ (Z))

    return (X->E0 [edge - 1]);

  return 0;

  }

double edge_energy (int Z, int edge) {

  X_ray_absorption_parameters_type * X;

  if (edge < 1 || edge > 4)

    return 0;

  if (X = __X_ray_AP_entry__ (Z))

    return (X->edge [edge - 1]);

  return 0;

  }

double Klein_Nishina_absorbance (double energy) {

  double a, l, t;

  a = energy / 511004.07;

  t = 1 + 2 * a;
  l = log (t) / a;

  return AVOGADRO * 2 * M_PI * (ELECTRON_RADIUS * ELECTRON_RADIUS * 10000)
         * ((1 + a) / (a * a) * (1 + 1 / t - l) +
            l / 2 - (t + a) / (t * t));

  }

double Victoreen_absorbance (int Z, double energy) {

  static X_ray_absorption_parameters_type X = { 0 }, * X_;

  int element, edge, region;

  double lambda;

  if (energy <= 0)

    return 0;

  if (Z != X.number)

    if (!(X_ = __X_ray_AP_entry__ (Z)))

      return 0;

  X = *X_;

  for (edge = 4; edge >= 0; edge--) {

    if (edge == 0 ? 1 : X.edge [edge - 1] > energy) {

      for (region = edge; region <= 4; region++)

        if (X.C [region] || X.D [region]) {

          lambda = _HC_ / energy;

          return lambda * lambda * lambda * (X.C [region]
                                 - lambda *  X.D [region]);

          }
      }
    }

  return 0;

  }

int Victoreen_coefficients (int Z, int edge,

                            double * C_b, double * D_b,
                            double * C_a, double * D_a) {

  X_ray_absorption_parameters_type * X;

  if (edge < 1 || edge > 4)

    return 0;

  if (X = __X_ray_AP_entry__ (Z)) {

    if (C_b)

      *C_b = X->C [edge];

    if (D_b)

      *D_b = X->D [edge];

    if (C_a)

      *C_a = X->C [edge - 1];

    if (D_a)

      *D_a = X->D [edge - 1];

    return 1;

    }

  return 0;

  }

double Victoreen (double E, double C_b, double D_b, double C_a, double D_a) {

    /* Calculate the victoreen curve at energy E, given the
                     victoreen coefficients C_b, D_b, C_a, and D_a. */

  double lambda;

  lambda = _HC_ / E;

    /* lambda is the wavelength in angstroms of the
                                   photon of energy x in eV. */

  return lambda * lambda * lambda * (C_a - C_b - (D_a - D_b) * lambda);

  }

int find_edge_type (double edge_E, int * Z, int * edge) {

  *Z = *edge = 0;

  if (edge_E) {

    int Z_, edge_;

    double E, min_err;

    for (Z_ = edge_ = 0, min_err = 1000; Z_ < 105; Z_++)

      for (edge_ = 1; edge_ <= 4; edge_++)

        if ((E = edge_energy (Z_, edge_)) != 0)

          if (fabs (E - edge_E) < min_err) {

            min_err = fabs (E - edge_E);

            *Z = Z_;
            *edge = edge_;

            }
    }

  return *Z;

  }

#endif /* __CONSTANTS_C__ */

